<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Maxicare Sales Presenter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --maxi-blue: #1e3a8a; --maxi-sky: #0ea5e9; --bg-grad-start: #f8fafc; --bg-grad-end: #e2e8f0; }
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            -webkit-font-smoothing: antialiased; 
            padding-bottom: 120px; 
            min-height: 100vh;
        }
        
        /* iPad Scrollbar Hiding */
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        
        /* Accordion Transitions */
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.5s ease; opacity: 0; }
        .accordion-content.open { max-height: 5000px; opacity: 1; padding-bottom: 1.5rem; }
        
        /* Product Cards - Modern Glassy Look */
        .product-card { 
            transition: transform 0.2s, box-shadow 0.2s; 
            border: 1px solid rgba(255,255,255,0.6);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }
        .product-card:active { transform: scale(0.99); }
        
        /* Custom Toggles */
        .toggle-label { position: relative; display: inline-block; width: 56px; height: 34px; }
        .toggle-label input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #cbd5e1; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        input:checked + .slider { background: linear-gradient(to right, #1e3a8a, #2563eb); }
        input:checked + .slider:before { transform: translateX(22px); }

        /* MyMaxicare Card Specifics */
        .mymax-card { 
            aspect-ratio: 1.586; 
            background-size: cover; 
            background-position: center; 
            border-radius: 1.25rem; 
            position: relative; 
            color: white; 
            background-color: #1e3a8a;
            text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.95);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .mymax-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.4) 50%, rgba(0,0,0,0.1) 100%);
        }

        .card-annual-price { font-size: 1.5rem; line-height: 1; font-weight: 800; }
        .card-semiannual-price { font-size: 0.95rem; line-height: 1; font-weight: 600; opacity: 0.9; }
        .card-price-label { font-size: 0.65rem; opacity: 0.8; font-weight: 500; margin-left: 2px; text-transform: uppercase; }
        
        .card-benefits-text { font-size: 0.8rem; line-height: 1.4; font-weight: 500; }
        .card-benefits-text li { margin-bottom: 4px; display: flex; align-items: center; }
        .card-benefits-text li::before { content: '✓'; margin-right: 6px; color: #4ade80; font-weight: bold; }

        /* Modal Content Styling */
        .details-modal-content h4 { font-weight: 800; color: #1e3a8a; margin-top: 1.25rem; margin-bottom: 0.75rem; font-size: 1.1rem; }
        .details-modal-content ul { list-style-type: none; padding-left: 0; margin-bottom: 1rem; }
        .details-modal-content li { margin-bottom: 0.5rem; color: #334155; padding-left: 1.5rem; position: relative; }
        .details-modal-content li::before { content: '•'; color: #0ea5e9; font-weight: bold; position: absolute; left: 0.5rem; font-size: 1.2em; line-height: 1; top: -2px;}
        .details-modal-content p { color: #475569; margin-bottom: 0.75rem; line-height: 1.6; }
        .benefit-highlight { background-color: #f0fdf4; padding: 1rem; border-radius: 0.75rem; border-left: 5px solid #22c55e; margin-bottom: 1rem; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        
        /* Floating Cart */
        .cart-float { 
            box-shadow: 0 10px 30px -5px rgba(37, 99, 235, 0.6); 
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        /* Header Gradient */
        .header-bg { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255,255,255,0.5); }
        
        /* Clinic Details */
        .clinic-detail-row { display: none; }
        .clinic-detail-row.show { display: block; animation: fadeIn 0.3s ease-out; }

        /* Highlights Modal Card */
        .highlight-card {
            display: flex;
            background: white;
            border-radius: 1.5rem;
            padding: 1.25rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            border: 1px solid #f1f5f9;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            align-items: flex-start;
            gap: 1rem;
        }
        .highlight-card:active { transform: scale(0.98); }
        .highlight-tag {
            color: white;
            font-size: 0.65rem;
            font-weight: 800;
            padding: 0.35rem 0.75rem;
            border-radius: 9999px;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            display: inline-block;
            letter-spacing: 0.05em;
        }
        .age-badge {
            background-color: #f3f4f6;
            color: #4b5563;
            font-size: 0.65rem;
            font-weight: 800;
            padding: 0.35rem 0.75rem;
            border-radius: 0.5rem;
            text-transform: uppercase;
            display: inline-block;
            margin-top: 0.75rem;
            letter-spacing: 0.05em;
        }
        
        /* Z-Index Management */
        .z-modal { z-index: 100; }
        .z-modal-content { z-index: 101; }
        .z-login { z-index: 9999; }

        /* BROCHURE TEMPLATE STYLES */
        #brochure-container {
            width: 800px;
            background: white;
            position: fixed;
            left: -9999px;
            top: 0;
            z-index: -1;
        }
        .brochure-header {
            background: linear-gradient(135deg, #1e3a8a, #1d4ed8);
            color: white;
            padding: 30px;
            clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
        }
        .brochure-body { padding: 25px 30px; }
        .brochure-section-title {
            color: #1e3a8a;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 4px;
            margin-bottom: 8px;
            margin-top: 16px;
            font-size: 1rem;
        }
        .brochure-list ul { margin-bottom: 0; }
        .brochure-list li {
            margin-bottom: 2px;
            padding-left: 20px;
            position: relative;
            color: #334155;
            font-size: 13px;
            line-height: 1.3;
        }
        .brochure-list li::before {
            content: '✓';
            color: #22c55e;
            font-weight: bold;
            position: absolute;
            left: 0;
            font-size: 12px;
        }
        /* Compact Table for Brochures */
        .compact-table td, .compact-table th {
            padding-top: 6px;
            padding-bottom: 6px;
            font-size: 13px;
        }
        .compact-table th {
            color: #1e3a8a;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 0.05em;
            border-bottom: 2px solid #e2e8f0;
        }
        .compact-table tr:last-child td { border-bottom: none; }
        .feature-row td { border-bottom: 1px solid #f1f5f9; }
        .feature-row:nth-child(even) { background-color: #f8fafc; }
        
        body.locked { overflow: hidden; }
    </style>
</head>
<body class="text-slate-800 locked" id="main-body">

    <!-- LOGIN OVERLAY -->
    <div id="login-overlay" class="fixed inset-0 bg-slate-900/60 backdrop-blur-lg z-login flex items-center justify-center p-6 transition-all duration-500">
        <div class="bg-white w-full max-w-sm rounded-3xl shadow-2xl p-8 text-center animate-fade-in border border-white/20">
            <div class="w-20 h-20 rounded-full bg-blue-100 mx-auto mb-6 flex items-center justify-center">
                <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
            </div>
            <h2 class="text-2xl font-extrabold text-slate-900 mb-2">Agent Login</h2>
            <p class="text-slate-500 text-sm mb-6">Please enter your Agent Code to unlock the dashboard.</p>
            
            <div class="space-y-4">
                <input type="text" id="agent-code-input" placeholder="Enter Agent Code (e.g. A1234567)" class="w-full px-4 py-3.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50 text-center font-bold text-lg uppercase tracking-widest placeholder-slate-400">
                <button onclick="checkLogin()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-blue-500/30 transition-all active:scale-95">Unlock Dashboard</button>
            </div>
            <p id="login-error" class="text-red-500 text-xs font-bold mt-4 hidden">Invalid Agent Code. Please try again.</p>
        </div>
    </div>

    <!-- APP CONTENT (Wrapped to be blurred initially) -->
    <div id="app-content" class="transition-all duration-500 blur-sm pointer-events-none">
        
        <!-- Fixed Header: Advisor Info -->
        <header class="header-bg sticky top-0 z-30 px-6 py-4 flex items-center justify-between transition-all duration-300 shadow-sm">
            <div class="flex items-center gap-4 cursor-pointer group" onclick="showContactModal()">
                <div class="relative">
                    <div class="absolute inset-0 bg-blue-400 rounded-full blur opacity-20 group-hover:opacity-40 transition-opacity"></div>
                    <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center text-white font-bold border-2 border-white shadow-md overflow-hidden relative z-10">
                        <span class="text-lg tracking-tight" id="header-initials">--</span>
                    </div>
                </div>
                <div>
                    <h1 class="font-bold text-xl leading-tight text-slate-900 group-hover:text-blue-700 transition-colors" id="header-name">Sales Agent</h1>
                    <p class="text-xs font-semibold text-blue-600 uppercase tracking-wide" id="header-designation">Health Benefit Consultant</p>
                </div>
            </div>
            <div class="flex gap-2">
                <!-- Highlights Button -->
                <button onclick="document.getElementById('highlights-modal').classList.remove('hidden'); document.getElementById('highlights-modal').classList.add('flex')" class="p-2.5 bg-yellow-50 border border-yellow-200 rounded-full hover:bg-yellow-100 hover:text-yellow-700 text-yellow-600 transition-all shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" /></svg>
                </button>
                <!-- Hierarchy Rules Button -->
                <button onclick="document.getElementById('hierarchy-modal').classList.remove('hidden'); document.getElementById('hierarchy-modal').classList.add('flex')" class="p-2.5 bg-purple-50 border border-purple-200 rounded-full hover:bg-purple-100 hover:text-purple-700 text-purple-600 transition-all shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                </button>
                <!-- Map Button -->
                <button onclick="document.getElementById('clinic-modal').classList.remove('hidden')" class="p-2.5 bg-white border border-slate-200 rounded-full hover:bg-blue-50 hover:border-blue-200 text-slate-500 hover:text-blue-600 transition-all shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                </button>
                <!-- Settings Button (New) -->
                <button onclick="document.getElementById('settings-modal').classList.remove('hidden'); document.getElementById('settings-modal').classList.add('flex')" class="p-2.5 bg-slate-100 border border-slate-300 rounded-full hover:bg-slate-200 hover:text-slate-800 text-slate-600 transition-all shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                </button>
            </div>
        </header>

        <main class="p-4 space-y-4 max-w-3xl mx-auto">
            
            <!-- SECTION 1: PRIMA -->
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-sm border border-white overflow-hidden">
                <button class="accordion-toggle w-full p-5 flex items-center justify-between bg-gradient-to-r from-blue-50/50 to-transparent hover:from-blue-100/50 transition-all text-left" data-target="prima-content">
                    <div class="flex items-center gap-4">
                        <div class="bg-gradient-to-br from-blue-500 to-blue-700 text-white p-2.5 rounded-xl shadow-lg shadow-blue-500/30">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-slate-800">PRIMA (Prepaid)</h2>
                            <p class="text-sm text-slate-500 font-medium">Unli Consult & Labs • Newborns to Seniors</p>
                        </div>
                    </div>
                    <svg class="w-6 h-6 text-slate-400 transform transition-transform duration-300 arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div id="prima-content" class="accordion-content open px-4">
                    <div class="pt-2 pb-4 space-y-4" id="prima-list-container">
                        <!-- Dynamic Content -->
                    </div>
                </div>
            </div>

            <!-- SECTION 2: LIFESAVER -->
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-sm border border-white overflow-hidden">
                <button class="accordion-toggle w-full p-5 flex items-center justify-between bg-gradient-to-r from-red-50/50 to-transparent hover:from-red-100/50 transition-all text-left" data-target="lifesaver-content">
                    <div class="flex items-center gap-4">
                        <div class="bg-gradient-to-br from-red-500 to-red-700 text-white p-2.5 rounded-xl shadow-lg shadow-red-500/30">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-slate-800">LifeSavER</h2>
                            <p class="text-sm text-slate-500 font-medium">Emergency Protection • 15 DAYS - 65 YEARS OLD</p>
                        </div>
                    </div>
                    <svg class="w-6 h-6 text-slate-400 transform transition-transform duration-300 arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div id="lifesaver-content" class="accordion-content px-4">
                    <div class="pt-2 pb-4 space-y-4" id="lifesaver-list-container">
                        <!-- Dynamic Content -->
                    </div>
                </div>
            </div>

            <!-- SECTION 3: MYMAXICARE -->
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-sm border border-white overflow-hidden">
                <button class="accordion-toggle w-full p-5 flex items-center justify-between bg-gradient-to-r from-cyan-50/50 to-transparent hover:from-cyan-100/50 transition-all text-left" data-target="mymaxicare-content">
                    <div class="flex items-center gap-4">
                        <div class="bg-gradient-to-br from-cyan-500 to-blue-600 text-white p-2.5 rounded-xl shadow-lg shadow-cyan-500/30">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-slate-800">MyMaxicare (Full HMO)</h2>
                            <p class="text-sm text-slate-500 font-medium">Comprehensive • 15 DAYS - 60 YEARS OLD</p>
                        </div>
                    </div>
                    <svg class="w-6 h-6 text-slate-400 transform transition-transform duration-300 arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
                <div id="mymaxicare-content" class="accordion-content px-4">
                    <div class="pt-2 pb-6">
                        <!-- Quick Calculator -->
                        <div class="bg-white p-6 rounded-2xl border border-slate-100 shadow-sm mb-6">
                            <h3 class="text-xs font-bold text-blue-500 uppercase tracking-widest mb-4 flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full bg-blue-500 inline-block"></span>
                                Quick Quote Calculator
                            </h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                                 <!-- Account Type -->
                                <div class="flex bg-slate-100 p-1.5 rounded-xl">
                                    <label class="flex-1 text-center py-3 rounded-lg cursor-pointer text-sm font-bold transition-all bg-white shadow-sm text-blue-700 ring-1 ring-black/5" id="type-ind-label">
                                        <input type="radio" name="accountType" value="individual" checked class="hidden" onchange="toggleAccountType('individual')"> Individual
                                    </label>
                                    <label class="flex-1 text-center py-3 rounded-lg cursor-pointer text-sm font-bold transition-all text-slate-500 hover:text-slate-700" id="type-fam-label">
                                        <input type="radio" name="accountType" value="family" class="hidden" onchange="toggleAccountType('family')"> Family
                                    </label>
                                </div>

                                <!-- Age Input -->
                                <div id="individual-input">
                                    <input type="number" id="age-input" placeholder="Enter Age (0-60)" class="w-full px-4 py-3.5 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-bold text-xl text-center text-slate-800 placeholder-slate-300 bg-slate-50/50">
                                </div>
                            </div>

                            <!-- Family Inputs (Hidden by default) -->
                            <div id="family-input" class="hidden mt-3 space-y-2">
                                 <div id="family-members-container" class="space-y-2"></div>
                                 <button onclick="addFamilyMember()" class="w-full py-3 border-2 border-dashed border-blue-300 text-blue-600 rounded-xl font-semibold hover:bg-blue-50 transition-colors flex items-center justify-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                                    Add Dependent
                                 </button>
                            </div>
                            
                            <!-- Riders -->
                            <div class="mt-6 space-y-3">
                                <div class="flex justify-between items-center p-3 bg-slate-50 rounded-xl border border-slate-100">
                                    <div class="flex flex-col">
                                        <span class="font-bold text-slate-700">Dental Benefit</span>
                                        <span class="text-xs text-slate-500">Unli Consult & Fillings</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-md">+₱387</span>
                                        <label class="toggle-label"><input type="checkbox" id="dental-toggle"><span class="slider"></span></label>
                                    </div>
                                </div>
                                 <div class="flex justify-between items-center p-3 bg-slate-50 rounded-xl border border-slate-100">
                                    <div class="flex flex-col">
                                        <span class="font-bold text-slate-700">Critical Illness</span>
                                        <span class="text-xs text-slate-500">Up to ₱50k Cash</span>
                                    </div>
                                    <div class="flex items-center gap-3">
                                        <span class="text-xs font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-md">+₱537</span>
                                        <label class="toggle-label"><input type="checkbox" id="ci-toggle"><span class="slider"></span></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- MyMaxicare Cards Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="mymaxicare-grid">
                            <!-- Card Plan Render -->
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Product Details Modal -->
    <div id="details-modal" class="fixed inset-0 bg-black/60 backdrop-blur-md z-modal hidden flex-col justify-end sm:justify-center p-0 sm:p-6 transition-opacity duration-300">
        <div class="bg-white w-full sm:max-w-2xl sm:mx-auto rounded-t-3xl sm:rounded-3xl shadow-2xl flex flex-col max-h-[90vh] animate-fade-in z-modal-content">
            <div class="p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50/80 rounded-t-3xl sticky top-0 z-10 backdrop-blur-sm">
                <h3 id="modal-title" class="text-xl font-extrabold text-slate-800 tracking-tight">Product Details</h3>
                <button onclick="document.getElementById('details-modal').classList.add('hidden'); document.getElementById('details-modal').classList.remove('flex')" class="text-slate-400 hover:text-slate-800 text-2xl w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-200 transition-colors">&times;</button>
            </div>
            <div id="modal-body" class="p-6 overflow-y-auto details-modal-content">
                <!-- Content Injected Here -->
            </div>
             <div class="p-4 bg-white border-t border-slate-100 rounded-b-3xl sticky bottom-0 flex gap-3 flex-col sm:flex-row">
                 <div id="shop-links-container" class="flex gap-2 justify-center w-full mb-2 sm:mb-0 sm:w-auto">
                     <!-- QR Codes injected here -->
                 </div>
                <button id="download-brochure-btn" class="flex-1 bg-blue-100 text-blue-700 font-bold py-3.5 rounded-2xl shadow-sm hover:bg-blue-200 transition-all flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                    Download Brochure
                </button>
                <button onclick="document.getElementById('details-modal').classList.add('hidden'); document.getElementById('details-modal').classList.remove('flex')" class="flex-1 bg-slate-800 text-white font-bold py-3.5 rounded-2xl shadow-lg hover:bg-slate-900 transition-all active:scale-98">Close</button>
            </div>
        </div>
    </div>

    <!-- Hidden Brochure Generator Template -->
    <div id="brochure-container">
        <!-- Content injected via JS -->
    </div>

    <!-- Settings Modal (New) -->
    <div id="settings-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-modal hidden flex-col justify-end sm:justify-center p-0 sm:p-6 transition-opacity duration-300">
        <div class="bg-white w-full sm:max-w-lg sm:mx-auto rounded-t-3xl sm:rounded-3xl shadow-2xl flex flex-col max-h-[85vh] animate-fade-in z-modal-content">
             <div class="p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50/80 rounded-t-3xl sticky top-0 z-10 backdrop-blur-sm">
                <h3 class="text-xl font-extrabold text-slate-800 tracking-tight">Agent Settings</h3>
                <button onclick="document.getElementById('settings-modal').classList.add('hidden'); document.getElementById('settings-modal').classList.remove('flex')" class="text-slate-400 hover:text-slate-800 text-2xl w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-200 transition-colors">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto bg-white space-y-4">
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-1">Website</label>
                    <input type="text" id="settings-website" class="w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50">
                </div>
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-1">FB Page Link</label>
                    <input type="text" id="settings-fb" class="w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50">
                </div>
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-1">PRIMA Shop Link</label>
                    <input type="text" id="settings-prima" class="w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50">
                </div>
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-1">LifeSavER Shop Link</label>
                    <input type="text" id="settings-lifesaver" class="w-full px-4 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50">
                </div>
            </div>
            <div class="p-4 bg-white border-t border-slate-100 rounded-b-3xl sticky bottom-0">
                <button onclick="saveSettings()" class="w-full bg-blue-600 text-white font-bold py-3.5 rounded-2xl shadow-lg hover:bg-blue-700 transition-all active:scale-98">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Highlights Modal -->
    <div id="highlights-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-modal hidden flex-col justify-end sm:justify-center p-0 sm:p-6 transition-opacity duration-300">
        <div class="bg-white w-full sm:max-w-lg sm:mx-auto rounded-t-3xl sm:rounded-3xl shadow-2xl flex flex-col max-h-[85vh] animate-fade-in z-modal-content">
            <div class="p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50/80 rounded-t-3xl sticky top-0 z-10 backdrop-blur-sm">
                <h3 class="text-xl font-extrabold text-slate-800 tracking-tight flex items-center gap-2">
                    <span class="text-yellow-500 text-2xl">★</span> Top Health Picks
                </h3>
                <button onclick="document.getElementById('highlights-modal').classList.add('hidden'); document.getElementById('highlights-modal').classList.remove('flex')" class="text-slate-400 hover:text-slate-800 text-2xl w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-200 transition-colors">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto space-y-4 bg-slate-50">
                <!-- PRIMA Card -->
                <div class="highlight-card" onclick="showDetails('PRIMA Consult', 'prima_consult')">
                    <img src="https://i.imgur.com/nbolBBP.png" class="w-24 h-auto rounded-lg object-contain">
                    <div class="flex-1">
                        <span class="highlight-tag bg-yellow-600">BEST SELLER</span>
                        <h4 class="font-bold text-slate-900 text-xl leading-tight">PRIMA Consult</h4>
                        <p class="text-blue-600 font-extrabold text-2xl my-1">₱999 <span class="text-xs font-medium text-slate-500">/ year</span></p>
                        <p class="text-sm text-slate-600 leading-snug">Unli Consult & APE (No Medical Exam)</p>
                         <span class="age-badge">Newborns to Seniors</span>
                    </div>
                </div>
                <!-- LifeSavER Card -->
                <div class="highlight-card" onclick="showDetails('LifeSavER', 'lifesaver_std')">
                    <img src="https://i.imgur.com/Mbe3BWN.png" class="w-24 h-auto rounded-lg object-contain">
                    <div class="flex-1">
                        <span class="highlight-tag bg-red-600">EMERGENCY</span>
                        <h4 class="font-bold text-slate-900 text-xl leading-tight">LifeSavER</h4>
                        <p class="text-blue-600 font-extrabold text-2xl my-1">₱2,299 <span class="text-xs font-medium text-slate-500">/ card</span></p>
                        <p class="text-sm text-slate-600 leading-snug">ER Coverage up to ₱25,000 (One-Time)</p>
                        <span class="age-badge">15 DAYS - 65 YEARS OLD</span>
                    </div>
                </div>
                 <!-- MyMaxicare Card -->
                <div class="highlight-card" onclick="showDetails('MyMaxicare (Silver)', 'silver')">
                    <img src="https://i.imgur.com/AZayUDB.png" class="w-24 h-auto rounded-lg object-contain shadow-sm">
                    <div class="flex-1">
                        <span class="highlight-tag bg-blue-800">FULL HMO</span>
                        <h4 class="font-bold text-slate-900 text-xl leading-tight">MyMaxicare (Silver)</h4>
                        <p class="text-blue-600 font-extrabold text-2xl my-1">₱18,674 <span class="text-xs font-medium text-slate-500">/year (varies per age)</span></p>
                        <p class="text-sm text-slate-600 leading-snug">Comprehensive Coverage (Confinement, Consultations, Labs & ER)</p>
                        <span class="age-badge">15 DAYS - 60 YEARS OLD</span>
                    </div>
                </div>
            </div>
             <div class="p-4 bg-white border-t border-slate-100 rounded-b-3xl sticky bottom-0">
                <button onclick="document.getElementById('highlights-modal').classList.add('hidden'); document.getElementById('highlights-modal').classList.remove('flex')" class="w-full bg-slate-800 text-white font-bold py-3.5 rounded-2xl shadow-lg hover:bg-slate-900 transition-all active:scale-98">Close</button>
            </div>
        </div>
    </div>
    
    <!-- Hierarchy Rules Modal -->
    <div id="hierarchy-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-modal hidden flex-col justify-end sm:justify-center p-0 sm:p-6 transition-opacity duration-300">
        <div class="bg-white w-full sm:max-w-3xl sm:mx-auto rounded-t-3xl sm:rounded-3xl shadow-2xl flex flex-col max-h-[85vh] animate-fade-in z-modal-content">
             <div class="p-5 border-b border-slate-100 flex justify-between items-center bg-slate-50/80 rounded-t-3xl sticky top-0 z-10 backdrop-blur-sm">
                <h3 class="text-xl font-extrabold text-slate-800 tracking-tight flex items-center gap-2"><span class="text-purple-600 text-2xl">❖</span> Enrollment Hierarchy Rules</h3>
                <button onclick="document.getElementById('hierarchy-modal').classList.add('hidden'); document.getElementById('hierarchy-modal').classList.remove('flex')" class="text-slate-400 hover:text-slate-800 text-2xl w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-200 transition-colors">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto bg-slate-50 text-sm">
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r-lg">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-yellow-700">
                                <span class="font-bold">Important Note:</span> For Family Accounts, eligible children must be <span class="font-bold underline">21 years old and below</span>.
                            </p>
                        </div>
                    </div>
                </div>

                <p class="text-slate-500 mb-4">Please refer to these guidelines for the hierarchy of eligible dependents for a <span class="font-bold text-slate-700">FAMILY ACCOUNT</span>.</p>
                
                <div class="space-y-4">
                    <!-- Row 1: Single -->
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-blue-100 text-blue-700 font-bold px-3 py-1 rounded-full text-xs">1</span>
                            <h4 class="font-bold text-slate-800 text-base">SINGLE</h4>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="bg-blue-50 p-2 rounded-lg border border-blue-100">
                                <span class="block text-[0.65rem] text-blue-400 font-bold uppercase mb-1">1st Priority</span>
                                <span class="font-bold text-slate-700">PARENTS</span>
                                <span class="block text-xs text-slate-500">(either 1 or both)</span>
                            </div>
                            <div class="bg-blue-50 p-2 rounded-lg border border-blue-100">
                                <span class="block text-[0.65rem] text-blue-400 font-bold uppercase mb-1">2nd Priority</span>
                                <span class="font-bold text-slate-700">SIBLINGS</span>
                                <span class="block text-xs text-slate-500">(eldest - youngest)</span>
                            </div>
                            <div class="bg-slate-100 p-2 rounded-lg border border-slate-200 flex items-center justify-center">
                                <span class="text-slate-400 italic text-xs">Nothing follows</span>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2: Single Parent -->
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-orange-100 text-orange-700 font-bold px-3 py-1 rounded-full text-xs">2</span>
                            <h4 class="font-bold text-slate-800 text-base">SINGLE PARENT</h4>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="bg-orange-50 p-2 rounded-lg border border-orange-100">
                                <span class="block text-[0.65rem] text-orange-400 font-bold uppercase mb-1">1st Priority</span>
                                <span class="font-bold text-slate-700">CHILDREN</span>
                                <span class="block text-xs text-slate-500">(eldest - youngest)</span>
                            </div>
                            <div class="bg-orange-50 p-2 rounded-lg border border-orange-100">
                                <span class="block text-[0.65rem] text-orange-400 font-bold uppercase mb-1">2nd Priority</span>
                                <span class="font-bold text-slate-700">PARENTS</span>
                                <span class="block text-xs text-slate-500">(either 1 or both)</span>
                            </div>
                            <div class="bg-orange-50 p-2 rounded-lg border border-orange-100">
                                <span class="block text-[0.65rem] text-orange-400 font-bold uppercase mb-1">3rd Priority</span>
                                <span class="font-bold text-slate-700">SIBLINGS</span>
                                <span class="block text-xs text-slate-500">(eldest - youngest)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Row 3: Married -->
                    <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-green-100 text-green-700 font-bold px-3 py-1 rounded-full text-xs">3</span>
                            <h4 class="font-bold text-slate-800 text-base">MARRIED</h4>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="bg-green-50 p-2 rounded-lg border border-green-100">
                                <span class="block text-[0.65rem] text-green-600 font-bold uppercase mb-1">1st Priority</span>
                                <span class="font-bold text-slate-700">SPOUSE</span>
                            </div>
                            <div class="bg-green-50 p-2 rounded-lg border border-green-100">
                                <span class="block text-[0.65rem] text-green-600 font-bold uppercase mb-1">2nd Priority</span>
                                <span class="font-bold text-slate-700">CHILDREN</span>
                                <span class="block text-xs text-slate-500">(eldest - youngest)</span>
                            </div>
                            <div class="bg-slate-100 p-2 rounded-lg border border-slate-200 flex items-center justify-center">
                                <span class="text-slate-400 italic text-xs">Nothing follows</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
             <div class="p-4 bg-white border-t border-slate-100 rounded-b-3xl sticky bottom-0">
                <button onclick="document.getElementById('hierarchy-modal').classList.add('hidden'); document.getElementById('hierarchy-modal').classList.remove('flex')" class="w-full bg-slate-800 text-white font-bold py-3.5 rounded-2xl shadow-lg hover:bg-slate-900 transition-all active:scale-98">Close</button>
            </div>
        </div>
    </div>

    <!-- Contact Info Modal -->
    <div id="contact-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-modal hidden flex items-center justify-center p-6">
        <div class="bg-white w-full max-w-sm rounded-3xl shadow-2xl p-8 text-center relative animate-fade-in z-modal-content">
            <button onclick="document.getElementById('contact-modal').classList.add('hidden')" class="absolute top-4 right-4 text-slate-400 hover:text-slate-800 text-2xl">&times;</button>
            <div class="w-24 h-24 rounded-full bg-blue-100 mx-auto mb-4 p-1 border-4 border-blue-50 shadow-inner flex items-center justify-center">
                 <span class="text-4xl font-bold text-blue-600 tracking-tight" id="modal-initials">JM</span>
            </div>
            <h2 class="text-2xl font-extrabold text-slate-900" id="modal-name">JM Caballes</h2>
            <p class="text-blue-600 font-semibold text-sm mb-6 uppercase tracking-wide">Health Benefit Consultant</p>
            <div class="bg-slate-50 p-4 rounded-2xl border border-slate-100 mb-6 flex flex-col items-center">
                <div id="vcard-qrcode" class="bg-white p-2 rounded-xl shadow-sm mb-3"></div>
                <p class="text-xs text-slate-500 font-medium">Scan to Save Contact</p>
            </div>
             <div class="space-y-3 text-left mb-6">
                 <p class="font-semibold text-slate-800" id="modal-mobile">Mobile: 0953 423 0904</p>
                 <p class="font-semibold text-slate-800" id="modal-website">Web: www.jmcaballes.life</p>
                 <p class="font-semibold text-slate-800" id="modal-email">Email: jm@maxicare.com.ph</p>
             </div>
        </div>
    </div>

    <!-- Clinic Search Modal -->
    <div id="clinic-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-modal hidden flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-2xl rounded-2xl shadow-2xl h-[85vh] flex flex-col animate-fade-in overflow-hidden z-modal-content">
            <div class="p-5 border-b flex justify-between items-center bg-slate-50 rounded-t-2xl sticky top-0 z-10">
                <h3 class="font-bold text-lg text-slate-800">Find a Maxicare Primary Care Clinic (PCC)</h3>
                <button onclick="document.getElementById('clinic-modal').classList.add('hidden')" class="text-2xl text-slate-500 hover:text-slate-800">&times;</button>
            </div>
            <div class="p-4 bg-white border-b border-slate-100 sticky top-[69px] z-10">
                <input type="text" id="clinic-search" placeholder="Search city, clinic name..." class="w-full pl-4 pr-4 py-3 rounded-xl border border-slate-300">
            </div>
            <div id="clinic-results" class="flex-1 overflow-y-auto p-4 space-y-3 bg-slate-50"></div>
        </div>
    </div>

    <!-- Image Preview Modal -->
    <div id="preview-modal" class="fixed inset-0 bg-black/95 z-[60] hidden flex flex-col items-center justify-center p-4">
        <img id="preview-img" class="max-h-[80vh] max-w-full rounded-lg shadow-2xl mb-6 border border-white/20">
        <div class="flex gap-4">
            <button onclick="document.getElementById('preview-modal').classList.add('hidden')" class="bg-white text-slate-900 px-8 py-3 rounded-full font-bold shadow-lg hover:bg-slate-200 transition-colors">Close</button>
            <p class="text-white text-sm self-center opacity-80">Long press image to save</p>
        </div>
    </div>

    <script>
        // --- AGENT DATABASE ---
        const agentDatabase = [
            { 
                code: "A469883", 
                name: "JM Caballes", 
                designation: "Health Benefit Consultant", 
                mobile: "0953 423 0904", 
                email: "maxicare@jmcaballes.life",
                website: "https://www.jmcaballes.life",
                fb: "https://fb.com/jmcabalyes",
                primaLink: "https://www.jmcaballes.life/prima",
                lifesaverLink: "https://www.jmcaballes.life/lifesaver"
            },
            { code: "AG002", name: "Juan Dela Cruz", designation: "Health Benefit Consultant", mobile: "0917 123 4567", email: "juan@maxicare.com.ph" },
            { code: "AG003", name: "Maria Clara", designation: "Financial Advisor", mobile: "0998 765 4321", email: "maria@maxicare.com.ph" }
        ];

        // --- DATA & CONFIG ---
        let advisor = { 
            name: '', 
            designation: 'Health Benefit Consultant',
            contact: '', 
            email: '',
            website: '', 
            fb: '',
            primaLink: '',
            lifesaverLink: ''
        };

        // --- LOGIN & SETTINGS LOGIC ---
        function checkLogin() {
            const input = document.getElementById('agent-code-input').value.trim();
            const agent = agentDatabase.find(a => a.code === input);
            
            if (agent) {
                // Update Advisor Info
                advisor.name = agent.name;
                advisor.designation = agent.designation;
                advisor.contact = agent.mobile;
                advisor.email = agent.email;
                
                // Populate extended info if available (with defaults)
                advisor.website = agent.website || '';
                advisor.fb = agent.fb || '';
                advisor.primaLink = agent.primaLink || '';
                advisor.lifesaverLink = agent.lifesaverLink || '';

                // Update UI
                updateAdvisorUI();
                
                // Unlock Dashboard
                document.getElementById('login-overlay').classList.add('opacity-0', 'pointer-events-none');
                
                // REMOVE BLUR AND ENABLE POINTER EVENTS
                const appContent = document.getElementById('app-content');
                appContent.classList.remove('blur-sm', 'pointer-events-none');
                
                // REMOVE OVERFLOW HIDDEN FROM BODY TO ENABLE SCROLLING
                document.body.classList.remove('overflow-hidden');
                document.body.classList.remove('locked');
                
                // Prefill Settings
                document.getElementById('settings-website').value = advisor.website;
                document.getElementById('settings-fb').value = advisor.fb;
                document.getElementById('settings-prima').value = advisor.primaLink;
                document.getElementById('settings-lifesaver').value = advisor.lifesaverLink;
            } else {
                const errorMsg = document.getElementById('login-error');
                errorMsg.classList.remove('hidden');
                document.getElementById('agent-code-input').classList.add('border-red-500', 'ring-red-500');
            }
        }

        function updateAdvisorUI() {
            // Update Header
            const headerName = document.getElementById('header-name');
            if(headerName) headerName.textContent = advisor.name;
            
            const headerDesignation = document.getElementById('header-designation');
            if(headerDesignation) headerDesignation.textContent = advisor.designation;
            
            const initials = advisor.name ? advisor.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase() : '--';
            const headerInitials = document.getElementById('header-initials');
            if(headerInitials) headerInitials.textContent = initials;

            // Update Contact Modal
            const modalName = document.getElementById('modal-name');
            if(modalName) modalName.textContent = advisor.name || "Sales Agent";
            
            const modalInitials = document.getElementById('modal-initials');
            if(modalInitials) modalInitials.textContent = initials;
            
            const modalMobile = document.getElementById('modal-mobile');
            if(modalMobile) modalMobile.textContent = 'Mobile: ' + (advisor.contact || "--");
            
            const modalEmail = document.getElementById('modal-email');
            if(modalEmail) modalEmail.textContent = 'Email: ' + (advisor.email || "--");
            
            // Conditionally hide/show Website in Modal
            const webEl = document.getElementById('modal-website');
            if(webEl) {
                if (advisor.website) {
                    webEl.textContent = 'Web: ' + advisor.website.replace('https://','');
                    webEl.classList.remove('hidden');
                } else {
                    webEl.classList.add('hidden');
                }
            }

            // Re-render QR with conditional VCard
            const qrTarget = document.getElementById("vcard-qrcode");
            if(qrTarget) {
                qrTarget.innerHTML = "";
                if(advisor.name) {
                    let vCardData = `BEGIN:VCARD\nVERSION:3.0\nFN:${advisor.name}\nTITLE:${advisor.designation}\nTEL;TYPE=CELL:${advisor.contact}\nEMAIL:${advisor.email}`;
                    if(advisor.website) {
                        vCardData += `\nURL:${advisor.website}`;
                    }
                    vCardData += `\nEND:VCARD`;
                    
                    new QRCode(qrTarget, { text: vCardData, width: 120, height: 120, colorDark : "#1e3a8a", colorLight : "#ffffff", correctLevel : QRCode.CorrectLevel.H });
                }
            }
        }

        function saveSettings() {
            advisor.website = document.getElementById('settings-website').value;
            advisor.fb = document.getElementById('settings-fb').value;
            advisor.primaLink = document.getElementById('settings-prima').value;
            advisor.lifesaverLink = document.getElementById('settings-lifesaver').value;
            
            updateAdvisorUI();
            document.getElementById('settings-modal').classList.add('hidden');
            document.getElementById('settings-modal').classList.remove('flex');
            alert('Settings saved!');
        }


        // --- GLOBAL PRODUCT DATA ---
        const primaProducts = [
            { id: 'prima_consult', name: 'PRIMA Consult', price: 999, subtitle: 'For All Ages (Newborns to Seniors)', img: 'https://i.imgur.com/nbolBBP.png', ageLimit: 'Newborns to Seniors', benefits: ['Unlimited Consultations (PCC)', 'Annual Check Up (Basic 5)', 'No Medical Exam', 'Pre-existing covered'] },
            { id: 'prima_access', name: 'PRIMA Access', price: 9999, subtitle: 'For All Ages (Newborns to Seniors)', img: 'https://i.imgur.com/ivnmS0Y.png', ageLimit: 'Newborns to Seniors', benefits: ['Unli Consult (PCC)', '24 Set A Lab Tests', '2x X-Ray & ECG, 1x UTZ', 'Pre-existing covered'] },
            { id: 'prima_elite', name: 'PRIMA Elite', price: 19999, subtitle: 'Total Care', img: 'https://i.imgur.com/BN8IXcT.png', ageLimit: 'Newborns to Seniors', benefits: ['Unli Consult & Labs', 'Choice of 3 Adv. Diagnostics', 'Pre-existing covered'] }
        ];

        const lifesaverProducts = [
            { id: 'lifesaver_std', name: 'LifeSavER', price: 2299, subtitle: 'Standard', img: 'https://i.imgur.com/Mbe3BWN.png', ageLimit: '15 DAYS - 65 YEARS OLD', benefits: ['₱25,000 Emergency Coverage', 'Standard Room', 'Valid for 1 year', 'One-time use'] },
            { id: 'lifesaver_plus', name: 'LifeSavER Plus', price: 6999, subtitle: 'With Confinement', img: 'https://i.imgur.com/TkNpL7L.png', ageLimit: '15 DAYS - 65 YEARS OLD', benefits: ['₱50,000 Coverage', 'Emergency & Confinement', 'Regular Private Room', 'Valid for 1 year'] }
        ];

        // --- DETAILED TEXT DATA ---
        const primaDetails = {
            prima_consult: {
                details: `<h4 class="font-bold mb-2 text-base text-slate-800">What's Included:</h4><ul><li><b>Unlimited Consultations</b> with a wide range of PCC specialists (IM, Pedia, OB-Gyne, ENT, etc.).</li><li><b>Annual Check Up (Basic 5):</b> Physical Exam, CBC, Urinalysis, Fecalysis, and Chest X-ray.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Key Features:</h4><ul><li><b>No Paperwork, No Preliminary Checkups.</b></li><li>Pre-existing conditions are welcome for consultation.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Exclusions:</h4><ul><li>Psychiatry consultations (out-of-pocket).</li><li>Hospital admission or confinement & Emergency cases.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Who is this For?</h4><p>Individuals who need affordable and regular access to doctor consultations.</p>`
            },
            prima_access: {
                details: `<h4 class="font-bold mb-2 text-base text-slate-800">What's Included:</h4><ul><li><b>Unlimited Consultations</b> with PCC specialists.</li><li><b>Annual Check Up (Basic 5)</b>.</li><li class="benefit-highlight"><b>Diagnostics & Labs (Outpatient):</b><ul class="!pl-4"><li><b>24</b> Set A Laboratory Tests.</li><li><b>2x</b> Chest X-Ray (PA).</li><li><b>2x</b> ECG.</li><li><b>1x</b> Ultrasound.</li></ul></li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Key Features:</h4><ul><li>Includes access to preferential rates for other tests.</li><li>Pre-existing conditions covered.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Who is this For?</h4><p>People who require more than just consultations, including regular lab work and diagnostics.</p>`
            },
            prima_elite: {
                details: `<h4 class="font-bold mb-2 text-base text-slate-800">What's Included:</h4><ul><li><b>Unlimited Consultations</b> with PCC specialists.</li><li><b>Annual Check Up (Basic 5)</b>.</li><li class="benefit-highlight"><b>Unlimited</b> Set A Laboratory Tests, X-rays, and ECGs.</li><li class="benefit-highlight"><b>Advanced Diagnostics:</b> Choice of any <b>three (3)</b> per year: Ultrasound, 2D Echo, Treadmill Stress Test, or CT Scan.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Key Features:</h4><ul><li>The ultimate outpatient plan with advanced diagnostics.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Who is this For?</h4><p>Those who seek the most comprehensive outpatient care.</p>`
            }
        };

        const lifesaverDetails = {
            lifesaver_std: {
                details: `<h4 class="font-bold mb-2 text-base text-slate-800">What's Included:</h4><ul><li><b>Outpatient Emergency Care Only.</b></li><li>One-time coverage up to <b>₱25,000</b>.</li><li>Doctor's services, ER fees, medicines, oxygen, IV fluids.</li><li>Dressings, casts, sutures, X-rays, labs (Emergency only).</li><li>Group Life with Accident Ins up to ₱50,000.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Exclusions (Chronic):</h4><ul><li>Hypertension, Diabetes, High Cholesterol.</li><li>COVID-related, Gallbladder stones, STDs.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">When to Use? (Medical Emergency)</h4><ul class="list-disc pl-5 text-sm text-slate-600 space-y-1"><li>Accidents (Broken bones, fractures, burns)</li><li>Acute Appendicitis</li><li>Animal Bites (Initial treatment)</li><li>Dengue, Typhoid, or Acute Gastroenteritis (Food Poisoning)</li><li>Severe allergic reactions or asthma attacks</li></ul><p class="text-xs text-slate-500 mt-2"><i>Must be availed within 24 hours of onset/injury.</i></p><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Key Features:</h4><ul><li><b>Validity:</b> 1 year from activation.</li><li><b>Activation:</b> 15 days after registration.</li></ul>`
            },
            lifesaver_plus: {
                details: `<h4 class="font-bold mb-2 text-base text-slate-800">What's Included:</h4><ul><li><b>Emergency Care leading to Confinement.</b></li><li>One-time coverage up to <b>₱50,000</b>.</li><li><b>Room & Board:</b> Regular Private.</li><li class="benefit-highlight"><b>Teleconsult:</b> Up to 12 sessions.</li><li>Group Life with Accident Ins up to ₱50,000.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">Exclusions (Chronic):</h4><ul><li>Hypertension, Diabetes, High Cholesterol.</li><li>COVID-related, Gallbladder stones, STDs.</li></ul><h4 class="font-bold mt-4 mb-2 text-base text-slate-800">When to Use? (Medical Emergency)</h4><ul class="list-disc pl-5 text-sm text-slate-600 space-y-1"><li>Accidents (Broken bones, fractures, burns)</li><li>Acute Appendicitis</li><li>Animal Bites (Initial treatment)</li><li>Dengue, Typhoid, or Acute Gastroenteritis (Food Poisoning)</li><li>Severe allergic reactions or asthma attacks</li></ul><p class="text-xs text-slate-500 mt-2"><i>Must be availed within 24 hours of onset/injury.</i></p>`
            }
        };

        const myMaxicareDetails = {}; 
        const myMaxicareStaticData = {
            silver: { name: 'Silver', mbl: '100,000', room: 'Semi-Private', price_desc: 'Starts at ₱15,000+', img: 'https://i.imgur.com/AZayUDB.png' },
            gold: { name: 'Gold', mbl: '150,000', room: 'Regular Private', price_desc: 'Starts at ₱20,000+', img: 'https://i.imgur.com/VLmnPq4.png' },
            platinum: { name: 'Platinum', mbl: '200,000', room: 'Regular Private', price_desc: 'Starts at ₱25,000+', img: 'https://i.imgur.com/Ps6RNvk.png' },
            platinumPlus: { name: 'Platinum Plus', mbl: '250,000', room: 'Large Private', price_desc: 'Starts at ₱47,000+', img: 'https://i.imgur.com/Vguiixx.png' }
        };

        const myMaxicareGeneralDetails = `
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-blue-50 p-3 rounded-lg border border-blue-100">
                    <h4 class="text-blue-900 font-bold mb-1 text-sm">In-Patient Care</h4>
                    <ul class="text-xs"><li>Room and Board</li><li>Operating Room, ICU, Isolation</li><li>Professional Fees</li><li>Nursing services & Medicines</li><li><b>Dreaded Conditions:</b> Covered (limits apply).</li></ul>
                </div>
                <div class="bg-slate-50 p-3 rounded-lg border border-slate-200">
                    <h4 class="text-slate-800 font-bold mb-1 text-sm">Out-Patient Care</h4>
                    <ul class="text-xs"><li>Consultations & procedures.</li><li><b>Access to PCCs.</b></li><li>Labs and Diagnostics.</li></ul>
                </div>
                <div class="bg-red-50 p-3 rounded-lg border border-red-100">
                    <h4 class="text-red-900 font-bold mb-1 text-sm">Emergency Care</h4>
                    <ul class="text-xs"><li><b>Affiliated:</b> 100% Covered up to MBL.</li><li><b>Non-Affiliated:</b> Reimbursable 80%.</li><li>Ambulance service.</li></ul>
                </div>
                <div class="p-3 border border-slate-200 rounded-lg">
                     <h4 class="font-bold mb-1 text-slate-800 text-sm">Preventive Care (ACU)</h4>
                     <p class="text-xs mb-1"><b>Basic 5 Routine:</b> Physical Exam, CBC, Urinalysis, Fecalysis, Chest X-ray (PA).</p>
                </div>
            </div>
            <div class="p-3 bg-yellow-50 rounded-lg border border-yellow-100 mt-3">
                <h4 class="font-bold mb-1 text-yellow-900 text-sm">Optional Benefits (Riders)</h4>
                <ul class="text-xs">
                    <li><b>Dental Benefit:</b> Unlimited consultations & fillings (+₱387).</li>
                    <li><b>Critical Illness Benefit:</b> Up to ₱50k cash assistance (+₱537).</li>
                </ul>
            </div>
            <div class="mt-4 p-3 bg-slate-50 rounded-lg border border-slate-200">
                <h4 class="font-bold mb-2 text-slate-900 text-sm">Pre-Existing Conditions (PEC) Coverage</h4>
                <table class="w-full text-xs text-left border-collapse">
                    <thead>
                        <tr class="border-b border-slate-200 text-slate-600">
                            <th class="py-1">Condition Type</th>
                            <th class="py-1">1st Year</th>
                            <th class="py-1">Subsequent Years</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-700">
                        <tr class="border-b border-slate-100">
                            <td class="py-1 font-semibold">Non-Dreaded (PE)</td>
                            <td class="py-1">Subject to Limit*</td>
                            <td class="py-1 text-green-600 font-bold">Up to MBL</td>
                        </tr>
                        <tr class="border-b border-slate-100">
                            <td class="py-1 font-semibold">Dreaded (PE)</td>
                            <td class="py-1">Subject to Limit*</td>
                            <td class="py-1">Subject to Limit*</td>
                        </tr>
                        <tr>
                            <td class="py-1 font-semibold">Acquired Dreaded</td>
                            <td class="py-1 text-green-600 font-bold">Up to MBL</td>
                            <td class="py-1 text-green-600 font-bold">Up to MBL</td>
                        </tr>
                    </tbody>
                </table>
                <p class="text-[10px] text-slate-500 mt-1">*Limit depends on plan: Platinum+ (20k), Platinum (15k), Gold (10k), Silver (5k)</p>
            </div>
        `;

        // --- STATE MANAGEMENT ---
        let familyMembers = []; 
        let currentQuote = {}; 
        let currentSemiQuote = {};
        let currentMonthlyQuote = {}; 
        let currentActiveRiders = []; 

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderPrima();
            renderLifeSavER();
            initMyMaxicare();
            setupAccordions();
            addFamilyMember(); 
            loadClinics();
            
            // Only update QR if advisor is already set via login logic (or defaults)
            // Here we use a dummy initial render just so it's not empty if viewed directly
            const vCardData = `BEGIN:VCARD\nVERSION:3.0\nFN:Maxicare\nTITLE:Health Benefit Consultant\nEND:VCARD`;
            const qrTarget = document.getElementById("vcard-qrcode");
            if(qrTarget) {
                 new QRCode(qrTarget, { text: vCardData, width: 120, height: 120, colorDark : "#1e3a8a", colorLight : "#ffffff", correctLevel : QRCode.CorrectLevel.H });
            }
        });

        function showContactModal() {
            document.getElementById('contact-modal').classList.remove('hidden');
            document.getElementById('contact-modal').classList.add('flex');
        }

        function setupAccordions() {
            document.querySelectorAll('.accordion-toggle').forEach(button => {
                button.addEventListener('click', () => {
                    const targetId = button.dataset.target;
                    const content = document.getElementById(targetId);
                    const arrow = button.querySelector('.arrow-icon');
                    
                    document.querySelectorAll('.accordion-content').forEach(c => {
                        if (c.id !== targetId) {
                            c.classList.remove('open');
                            c.previousElementSibling.querySelector('.arrow-icon').style.transform = 'rotate(0deg)';
                        }
                    });

                    if (content.classList.contains('open')) {
                        content.classList.remove('open');
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        content.classList.add('open');
                        arrow.style.transform = 'rotate(180deg)';
                    }
                });
            });
        }

        // --- UPDATED SHOW DETAILS (Handles Brochure Logic) ---
        function showDetails(title, id) {
            document.getElementById('modal-title').textContent = title;
            
            let contentHtml = '';
            let type = '';

            // Identify Product Type & Content
            if (id.startsWith('prima')) {
                contentHtml = primaDetails[id].details;
                type = 'prima';
            } else if (id.startsWith('lifesaver')) {
                contentHtml = lifesaverDetails[id].details;
                type = 'lifesaver';
            } else if (myMaxicareDetails[id]) { 
                 contentHtml = myMaxicareDetails[id]; 
                 type = 'mymax';
            } else if (myMaxicareStaticData[id]) { // Fix for highlight modal click
                 // If clicked from highlights modal (which passes key 'silver', 'gold', etc.)
                 // we need to generate content if not yet available
                 if(myMaxicareDetails[id]) {
                     contentHtml = myMaxicareDetails[id];
                 } else {
                     // Fallback if not yet calculated
                     const staticData = myMaxicareStaticData[id];
                     contentHtml = `
                        <div class="mb-6 bg-blue-50/80 p-5 border-l-4 border-blue-500 rounded-r-xl">
                            <h4 class="font-bold text-lg text-blue-900">${staticData.name} Plan Highlights</h4>
                            <ul class="list-disc pl-5 mt-2 text-slate-700">
                                <li><b>Max Benefit Limit (MBL):</b> ₱${staticData.mbl} per illness/year</li>
                                <li><b>Room & Board:</b> ${staticData.room}</li>
                            </ul>
                        </div>
                        ${myMaxicareGeneralDetails}
                     `;
                 }
                 type = 'mymax';
            }

            document.getElementById('modal-body').innerHTML = contentHtml;
            
            // Setup Shop Link QRs Logic
            const linkContainer = document.getElementById('shop-links-container');
            linkContainer.innerHTML = ''; // Clear previous QRs

            if (type === 'prima' && advisor.primaLink) {
                const div = document.createElement('div');
                div.className = "flex flex-col items-center p-2 bg-blue-50 rounded-lg border border-blue-100";
                const qrDiv = document.createElement('div');
                new QRCode(qrDiv, { text: advisor.primaLink, width: 60, height: 60, colorDark : "#1e3a8a" });
                div.appendChild(qrDiv);
                const span = document.createElement('span');
                span.className = "text-[10px] font-bold text-blue-800 mt-1 uppercase";
                span.innerText = "Shop Online";
                div.appendChild(span);
                linkContainer.appendChild(div);
            }
            if (type === 'lifesaver' && advisor.lifesaverLink) {
                 const div = document.createElement('div');
                div.className = "flex flex-col items-center p-2 bg-red-50 rounded-lg border border-red-100";
                const qrDiv = document.createElement('div');
                new QRCode(qrDiv, { text: advisor.lifesaverLink, width: 60, height: 60, colorDark : "#ef4444" });
                div.appendChild(qrDiv);
                const span = document.createElement('span');
                span.className = "text-[10px] font-bold text-red-800 mt-1 uppercase";
                span.innerText = "Shop Online";
                div.appendChild(span);
                linkContainer.appendChild(div);
            }

            
            // Setup Download Button
            const btn = document.getElementById('download-brochure-btn');
            btn.onclick = () => generateBrochure(title, id, type);

            const modal = document.getElementById('details-modal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function formatCurrency(amount) {
            if (isNaN(amount) || amount === null) return 'N/A';
            return new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP', minimumFractionDigits: 0 }).format(amount);
        }

        // --- BROCHURE GENERATOR LOGIC ---
        async function generateBrochure(title, id, type) {
            const container = document.getElementById('brochure-container');
            let productData, detailsHtml, priceText, subHeader, imgUrl;
            let shopLinkQrHtml = ''; // Placeholder for Shop Link QR in brochure

            // 1. Data Retrieval
            if (type === 'prima') {
                // CONSOLIDATED PRIMA BROCHURE
                title = "Maxicare PRIMA Plans";
                subHeader = "Prepaid Health Cards for All Ages (Newborns to Seniors)";
                priceText = ""; 
                imgUrl = "https://i.imgur.com/nbolBBP.png"; 

                if(advisor.primaLink){
                     shopLinkQrHtml = `<div class="bg-white p-1.5 shadow-md border border-slate-200 rounded-lg flex flex-col items-center">
                        <div id="brochure-shop-qr"></div>
                        <span class="text-[8px] font-bold text-slate-500 mt-1 uppercase">Shop Online</span>
                     </div>`;
                }

                detailsHtml = `
                    <div class="mb-4">
                        <table class="w-full text-left border-collapse compact-table">
                            <thead>
                                <tr class="border-b-2 border-slate-200 text-blue-900 text-xs uppercase tracking-wide">
                                    <th class="py-1.5 pl-2">Benefit</th>
                                    <th class="py-1.5 text-center">Consult (₱999)</th>
                                    <th class="py-1.5 text-center">Access (₱9,999)</th>
                                    <th class="py-1.5 text-center">Elite (₱19,999)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Consultations</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Unlimited (PCC)</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Unlimited (PCC)</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Unlimited (PCC)</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Lab Tests</td>
                                    <td class="py-2 text-center text-xs text-slate-600">ACU Basic 5</td>
                                    <td class="py-2 text-center text-xs text-slate-600">ACU + 24 Set A Tests</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Unlimited (Set A)</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Basic Diag.</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Preferential Rates</td>
                                    <td class="py-2 text-center text-xs text-slate-600">2x X-Ray/ECG</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Unlimited X-Ray/ECG</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Advanced Diag.</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Preferential Rates</td>
                                    <td class="py-2 text-center text-xs text-slate-600">1x Ultrasound</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Choice of 3 (UTZ/CT/Echo/Treadmill)</td>
                                </tr>
                                 <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Eligibility</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Newborns to Seniors</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Newborns to Seniors</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Newborns to Seniors</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="p-3 bg-blue-50 rounded-lg border border-blue-100 text-xs mt-4">
                        <h4 class="font-bold text-blue-900 mb-1">Common Features:</h4>
                        <ul class="list-disc pl-4">
                            <li>No Medical Exam required.</li>
                            <li>Pre-existing conditions are covered for consultations.</li>
                            <li>Valid for 1 year upon activation.</li>
                            <li><b>Exclusion:</b> Psychiatry consultations (out-of-pocket), Hospital confinement.</li>
                        </ul>
                    </div>
                `;
            } 
            else if (type === 'lifesaver') {
                // CONSOLIDATED LIFESAVER BROCHURE
                title = "Maxicare LifeSavER";
                subHeader = "One-Time Emergency Protection (15 days - 65 yrs old)";
                priceText = "";
                imgUrl = "https://i.imgur.com/Mbe3BWN.png"; 

                if(advisor.lifesaverLink){
                     shopLinkQrHtml = `<div class="bg-white p-1.5 shadow-md border border-slate-200 rounded-lg flex flex-col items-center">
                        <div id="brochure-shop-qr"></div>
                        <span class="text-[8px] font-bold text-slate-500 mt-1 uppercase">Shop Online</span>
                     </div>`;
                }

                detailsHtml = `
                    <div class="mb-4">
                        <table class="w-full text-left border-collapse compact-table">
                            <thead>
                                <tr class="border-b-2 border-slate-200 text-blue-900 text-xs uppercase tracking-wide">
                                    <th class="py-1.5 pl-2">Feature</th>
                                    <th class="py-1.5 text-center">Standard (₱2,299)</th>
                                    <th class="py-1.5 text-center">Plus (₱6,999)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Coverage Limit</td>
                                    <td class="py-2 text-center text-xs text-slate-600 font-bold">₱25,000</td>
                                    <td class="py-2 text-center text-xs text-slate-600 font-bold">₱50,000</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Usage</td>
                                    <td class="py-2 text-center text-xs text-slate-600">One-time use</td>
                                    <td class="py-2 text-center text-xs text-slate-600">One-time use</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Type</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Outpatient ER Only</td>
                                    <td class="py-2 text-center text-xs text-slate-600">ER Leading to Confinement</td>
                                </tr>
                                 <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Room</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Standard</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Regular Private</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50">
                                    <td class="py-2 pl-2 font-bold text-slate-700 text-xs">Teleconsult</td>
                                    <td class="py-2 text-center text-xs text-slate-600">-</td>
                                    <td class="py-2 text-center text-xs text-slate-600">Up to 12 Sessions</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="p-3 bg-red-50 rounded-lg border border-red-100 text-xs mt-4">
                        <h4 class="font-bold text-red-900 mb-1">When to Use? (Medical Emergency)</h4>
                        <ul class="list-disc pl-4 space-y-1 mb-3">
                            <li>Accidents (Broken bones, fractures, burns)</li>
                            <li>Acute Appendicitis</li>
                            <li>Animal Bites (Initial treatment)</li>
                            <li>Dengue, Typhoid, or Acute Gastroenteritis (Food Poisoning)</li>
                            <li>Severe allergic reactions or asthma attacks</li>
                        </ul>
                        <p class="text-xs text-slate-500 italic">Must be availed within 24 hours of onset/injury.</p>
                        
                        <h4 class="font-bold text-red-900 mt-3 mb-1">Important Notes:</h4>
                        <ul class="list-disc pl-4">
                            <li>Group Life with Accident Insurance included (up to ₱50k).</li>
                            <li><b>Exclusions:</b> Chronic conditions (Hypertension, Diabetes, etc.), COVID-related.</li>
                            <li>Activation: 15 days after registration. Validity: 1 year.</li>
                        </ul>
                    </div>
                `;
            } 
            else if (type === 'mymax') {
                // Consolidated Brochure Logic
                title = "MyMaxicare Complete Plans";
                
                // Determine Account Type & Age
                const isFamily = document.querySelector('input[name="accountType"]:checked').value === 'family';
                let ageText = '';
                if (isFamily) {
                    const ages = Array.from(document.querySelectorAll('.fam-age-input')).map(i => i.value).filter(v => v).join(', ');
                    ageText = `Family Account | Ages: ${ages}`;
                } else {
                    const age = document.getElementById('age-input').value;
                    ageText = `Individual Account | Age: ${age}`;
                }
                
                subHeader = `${ageText}`;
                priceText = ""; // Hide single price
                imgUrl = "https://i.imgur.com/Vguiixx.png"; // Generic image (Platinum Plus)

                let tableRows = '';
                const plans = ['silver', 'gold', 'platinum', 'platinumPlus'];
                
                plans.forEach(planKey => {
                    const staticData = myMaxicareStaticData[planKey];
                    let annualPrice = (currentQuote && currentQuote[planKey] > 0) ? formatCurrency(currentQuote[planKey]) : staticData.price_desc;
                    let semiAnnualPrice = (currentSemiQuote && currentSemiQuote[planKey] > 0) ? formatCurrency(currentSemiQuote[planKey]) : 'N/A';
                    let monthlyPrice = (currentMonthlyQuote && currentMonthlyQuote[planKey] > 0) ? formatCurrency(currentMonthlyQuote[planKey]) : 'N/A';
                    
                    // If static desc is used for annual, represent semi as '---'
                    if(annualPrice.includes('Starts')) {
                        semiAnnualPrice = '---';
                        monthlyPrice = '---';
                    }

                    tableRows += `
                        <tr class="border-b border-slate-100 hover:bg-slate-50">
                            <td class="py-2 pl-2 font-bold text-blue-900 text-sm">${staticData.name}</td>
                            <td class="py-2 text-slate-600 text-xs">${staticData.mbl.replace('k',',000')}</td>
                            <td class="py-2 text-slate-600 text-xs">${staticData.room}</td>
                            <td class="py-2 font-bold text-right text-slate-800 text-sm">${annualPrice}</td>
                            <td class="py-2 font-medium text-right text-slate-500 text-xs pr-2">${semiAnnualPrice}</td>
                            <td class="py-2 font-medium text-right text-blue-600 text-xs pr-2 font-bold">${monthlyPrice}</td>
                        </tr>
                    `;
                });

                let ridersNote = '';
                if(currentActiveRiders.length > 0) {
                    ridersNote = `<div class="mt-2 p-2 bg-yellow-50 text-yellow-800 text-xs rounded border border-yellow-100">
                        <strong>Includes:</strong> ${currentActiveRiders.join(', ')}
                    </div>`;
                }

                detailsHtml = `
                    <div class="mb-4">
                        <table class="w-full text-left border-collapse compact-table">
                            <thead>
                                <tr class="border-b-2 border-slate-200 text-blue-900 text-xs uppercase tracking-wide">
                                    <th class="py-1.5 pl-2">Plan Type</th>
                                    <th class="py-1.5">MBL</th>
                                    <th class="py-1.5">Room</th>
                                    <th class="py-1.5 text-right">Annual</th>
                                    <th class="py-1.5 text-right pr-2">Semi-Annual</th>
                                    <th class="py-1.5 text-right pr-2">Monthly*</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tableRows}
                            </tbody>
                        </table>
                        <div class="mt-1 text-[10px] text-slate-500 italic">* Monthly rate is <b>exclusive to BPI & Metrobank Credit Cards</b></div>
                        ${ridersNote}
                    </div>
                    ${myMaxicareGeneralDetails}
                `;
            }

            // 2. Build the Flyer HTML
            // Prepare conditional HTML for optional fields
            let optionalLinksHtml = '';

            if (advisor.website) {
                optionalLinksHtml += `<p class="flex items-center gap-2">🌐 ${advisor.website.replace(/^https?:\/\//, '')}</p>`;
            }

            if (advisor.fb) {
                optionalLinksHtml += `<p class="flex items-center gap-2">👍 ${advisor.fb.replace(/^https?:\/\//, '')}</p>`;
            }

            container.innerHTML = `
                <div class="brochure-header relative overflow-hidden">
                    <div class="flex justify-between items-start relative z-10">
                        <div class="w-2/3">
                            <h1 class="text-3xl font-extrabold text-white mb-1 tracking-tight leading-tight">${title}</h1>
                            <p class="text-blue-100 text-lg font-medium">${subHeader}</p>
                            ${priceText ? `<div class="mt-4 inline-block bg-white text-blue-800 font-extrabold text-2xl px-5 py-1.5 rounded-lg shadow-lg">${priceText}</div>` : ''}
                        </div>
                        <div class="text-right">
                            <h2 class="text-white font-bold text-lg">${advisor.name}</h2>
                            <p class="text-blue-200 text-xs uppercase tracking-widest">${advisor.designation}</p>
                        </div>
                    </div>
                    <img src="${imgUrl}" class="absolute -right-12 -bottom-12 w-48 h-auto object-contain opacity-50 transform rotate-12" style="filter: drop-shadow(0 10px 10px rgba(0,0,0,0.3));">
                </div>
                
                <div class="brochure-body">
                    <!-- Benefits Content -->
                    <div class="text-slate-700 leading-snug brochure-list">
                        ${detailsHtml}
                    </div>

                    <!-- Footer / Call to Action -->
                    <div class="mt-6 pt-4 border-t-2 border-slate-100 flex items-center justify-between">
                        <div>
                            <h4 class="font-bold text-slate-900 text-base mb-1">Ready to get protected?</h4>
                            <p class="text-slate-500 text-xs mb-2">Contact your advisor to proceed.</p>
                            
                            <div class="space-y-0.5 text-xs font-medium text-slate-700">
                                <p class="flex items-center gap-2">📞 ${advisor.contact}</p>
                                <p class="flex items-center gap-2">✉️ ${advisor.email}</p>
                                ${optionalLinksHtml}
                            </div>
                        </div>
                        
                        <div class="flex gap-2">
                             ${shopLinkQrHtml}
                             <div id="brochure-contact-qr" class="bg-white p-1.5 shadow-md border border-slate-200 rounded-lg flex flex-col items-center">
                                <div id="brochure-qr-target"></div>
                                <span class="text-[8px] font-bold text-slate-500 mt-1 uppercase">Contact Me</span>
                             </div>
                        </div>
                    </div>
                    <div class="mt-4 text-center text-[10px] text-slate-400">
                        Prices and benefits subject to change.
                    </div>
                </div>
            `;

            // 3. Generate QRs inside Flyer
            // Contact QR (Always generate vCard, only add URL if present)
            if(advisor.name) {
                let contactVCard = `BEGIN:VCARD\nVERSION:3.0\nFN:${advisor.name}\nTITLE:${advisor.designation}\nTEL;TYPE=CELL:${advisor.contact}\nEMAIL:${advisor.email}`;
                if (advisor.website) {
                    contactVCard += `\nURL:${advisor.website}`;
                }
                contactVCard += `\nEND:VCARD`;
                
                new QRCode(document.getElementById("brochure-qr-target"), { text: contactVCard, width: 80, height: 80, colorDark: "#1e3a8a" });
            }
            
            // Shop Link QR (if applicable)
            if (type === 'prima' && advisor.primaLink) {
                 new QRCode(document.getElementById("brochure-shop-qr"), { text: advisor.primaLink, width: 80, height: 80, colorDark: "#1e3a8a" });
            } else if (type === 'lifesaver' && advisor.lifesaverLink) {
                 new QRCode(document.getElementById("brochure-shop-qr"), { text: advisor.lifesaverLink, width: 80, height: 80, colorDark: "#ef4444" });
            }


            // 4. Render to Image
            try {
                // Wait for DOM to settle
                await new Promise(r => setTimeout(r, 300));
                
                const canvas = await html2canvas(container, { 
                    scale: 2, // High resolution
                    useCORS: true, // Handle images
                    backgroundColor: '#ffffff'
                });

                const imgData = canvas.toDataURL('image/png');
                
                // Show Preview Modal
                const previewImg = document.getElementById('preview-img');
                previewImg.src = imgData;
                
                const previewModal = document.getElementById('preview-modal');
                previewModal.classList.remove('hidden');
                previewModal.classList.add('flex');

                // Auto download (optional, but good UX for desktop)
                const link = document.createElement('a');
                link.download = `${title.replace(/\s+/g, '_')}_Brochure.png`;
                link.href = imgData;
                link.click();

            } catch (err) {
                console.error("Brochure Gen Error:", err);
                alert("Could not generate brochure. Please try again.");
            }
        }

        // --- RENDER FUNCTIONS (PRIMA) ---
        function renderPrima() {
            const container = document.getElementById('prima-list-container');
            container.innerHTML = primaProducts.map(p => `
                <div class="product-card rounded-xl overflow-hidden">
                    <div class="flex p-4 gap-4 items-center" onclick="showDetails('${p.name}', '${p.id}')">
                        <img src="${p.img}" class="w-28 h-auto object-contain rounded-lg shadow-sm self-start transform hover:scale-105 transition-transform">
                        <div class="flex-1">
                            <h3 class="font-extrabold text-slate-800 text-lg leading-tight">${p.name}</h3>
                            <p class="text-xs text-blue-600 font-bold mb-2 uppercase tracking-wide">${p.subtitle}</p>
                            <ul class="benefit-list mb-3">
                                ${p.benefits.map(b => `<li>${b}</li>`).join('')}
                            </ul>
                            <div class="flex justify-between items-center mt-3 border-t pt-3 border-slate-100">
                                <span class="font-extrabold text-2xl text-slate-800">${formatCurrency(p.price)}<span class="text-xs text-slate-400 font-semibold ml-1">/year</span></span>
                            </div>
                             <span class="age-badge mt-2">${p.ageLimit}</span>
                        </div>
                    </div>
                    <div class="px-4 pb-4">
                        <button onclick="showDetails('${p.name}', '${p.id}')" class="w-full py-2.5 bg-slate-100 text-slate-600 font-bold rounded-xl text-sm hover:bg-slate-200 hover:text-slate-800 transition-all">View Details</button>
                    </div>
                </div>
            `).join('');
        }

        // --- RENDER FUNCTIONS (LIFESAVER) ---
        function renderLifeSavER() {
            const container = document.getElementById('lifesaver-list-container');
            container.innerHTML = lifesaverProducts.map(p => `
                <div class="product-card rounded-xl overflow-hidden">
                    <div class="flex p-4 gap-4 items-center" onclick="showDetails('${p.name}', '${p.id}')">
                        <img src="${p.img}" class="w-28 h-auto object-contain rounded-lg shadow-sm self-start transform hover:scale-105 transition-transform">
                        <div class="flex-1">
                            <h3 class="font-extrabold text-slate-800 text-lg leading-tight">${p.name}</h3>
                            <p class="text-xs text-red-500 font-bold mb-2 uppercase tracking-wide">${p.subtitle}</p>
                            <ul class="benefit-list mb-3">
                                ${p.benefits.map(b => `<li>${b}</li>`).join('')}
                            </ul>
                             <div class="flex justify-between items-center mt-3 border-t pt-3 border-slate-100">
                                <span class="font-extrabold text-2xl text-slate-800">${formatCurrency(p.price)}<span class="text-xs text-slate-400 font-semibold ml-1">/card</span></span>
                            </div>
                             <span class="age-badge mt-2">${p.ageLimit}</span>
                        </div>
                    </div>
                    <div class="px-4 pb-4">
                        <button onclick="showDetails('${p.name}', '${p.id}')" class="w-full py-2.5 bg-slate-100 text-slate-600 font-bold rounded-xl text-sm hover:bg-slate-200 hover:text-slate-800 transition-all">View Details</button>
                    </div>
                </div>
            `).join('');
        }

        // --- MYMAXICARE LOGIC ---
        // (Rates Arrays - Collapsed for brevity, assume full data present as per original)
        const individualAnnualRates = [ { ageMin: 0, ageMax: 5, rates: { platinumPlus: 72403, platinum: 42443, gold: 37573, silver: 27843 } }, { ageMin: 6, ageMax: 10, rates: { platinumPlus: 59282, platinum: 34001, gold: 29415, silver: 23199 } }, { ageMin: 11, ageMax: 15, rates: { platinumPlus: 48852, platinum: 27365, gold: 24201, silver: 19632 } }, { ageMin: 16, ageMax: 20, rates: { platinumPlus: 47322, platinum: 25271, gold: 23159, silver: 18674 } }, { ageMin: 21, ageMax: 25, rates: { platinumPlus: 47055, platinum: 26364, gold: 22623, silver: 18674 } }, { ageMin: 26, ageMax: 30, rates: { platinumPlus: 48852, platinum: 29152, gold: 26542, silver: 21245 } }, { ageMin: 31, ageMax: 35, rates: { platinumPlus: 58543, platinum: 34553, gold: 32009, silver: 22884 } }, { ageMin: 36, ageMax: 40, rates: { platinumPlus: 73603, platinum: 45522, gold: 42014, silver: 27866 } }, { ageMin: 41, ageMax: 45, rates: { platinumPlus: 93488, platinum: 61893, gold: 53800, silver: 41774 } }, { ageMin: 46, ageMax: 50, rates: { platinumPlus: 111362, platinum: 83525, gold: 64494, silver: 50006 } }, { ageMin: 51, ageMax: 55, rates: { platinumPlus: 125647, platinum: 101796, gold: 67461, silver: 50020 } }, { ageMin: 56, ageMax: 60, rates: { platinumPlus: 138743, platinum: 115275, gold: 78660, silver: 55571 } } ];
        const individualSemiAnnualRates = [ { ageMin: 0, ageMax: 5, rates: { platinumPlus: 39098, platinum: 22919, gold: 20289, silver: 15035 } }, { ageMin: 6, ageMax: 10, rates: { platinumPlus: 32012, platinum: 18361, gold: 15884, silver: 12527 } }, { ageMin: 11, ageMax: 15, rates: { platinumPlus: 26380, platinum: 14777, gold: 13069, silver: 10601 } }, { ageMin: 16, ageMax: 20, rates: { platinumPlus: 25554, platinum: 13646, gold: 12506, silver: 10084 } }, { ageMin: 21, ageMax: 25, rates: { platinumPlus: 25410, platinum: 14237, gold: 12216, silver: 10084 } }, { ageMin: 26, ageMax: 30, rates: { platinumPlus: 26380, platinum: 15742, gold: 14333, silver: 11472 } }, { ageMin: 31, ageMax: 35, rates: { platinumPlus: 31613, platinum: 18659, gold: 17285, silver: 12357 } }, { ageMin: 36, ageMax: 40, rates: { platinumPlus: 39746, platinum: 24582, gold: 22688, silver: 15048 } }, { ageMin: 41, ageMax: 45, rates: { platinumPlus: 50484, platinum: 33422, gold: 29052, silver: 22558 } }, { ageMin: 46, ageMax: 50, rates: { platinumPlus: 60135, platinum: 45104, gold: 34827, silver: 27003 } }, { ageMin: 51, ageMax: 55, rates: { platinumPlus: 67849, platinum: 54970, gold: 36429, silver: 27011 } }, { ageMin: 56, ageMax: 60, rates: { platinumPlus: 74921, platinum: 62249, gold: 42476, silver: 30008 } } ];
        
        const familyAnnualRates = [ { ageMin: 0, ageMax: 5, rates: { platinumPlus: 59205, platinum: 38563, gold: 31019, silver: 24405 } }, { ageMin: 6, ageMax: 10, rates: { platinumPlus: 48449, platinum: 30980, gold: 25001, silver: 19882 } }, { ageMin: 11, ageMax: 15, rates: { platinumPlus: 42206, platinum: 25125, gold: 20616, silver: 17068 } }, { ageMin: 16, ageMax: 20, rates: { platinumPlus: 38506, platinum: 22992, gold: 18417, silver: 16217 } }, { ageMin: 21, ageMax: 25, rates: { platinumPlus: 38885, platinum: 24574, gold: 18157, silver: 16162 } }, { ageMin: 26, ageMax: 30, rates: { platinumPlus: 40723, platinum: 27073, gold: 21374, silver: 17930 } }, { ageMin: 31, ageMax: 35, rates: { platinumPlus: 46057, platinum: 32579, gold: 24954, silver: 19422 } }, { ageMin: 36, ageMax: 40, rates: { platinumPlus: 52564, platinum: 41188, gold: 31625, silver: 23129 } }, { ageMin: 41, ageMax: 45, rates: { platinumPlus: 68051, platinum: 53520, gold: 39408, silver: 33317 } }, { ageMin: 46, ageMax: 50, rates: { platinumPlus: 91302, platinum: 71555, gold: 50194, silver: 41512 } }, { ageMin: 51, ageMax: 55, rates: { platinumPlus: 107329, platinum: 87296, gold: 52712, silver: 41697 } }, { ageMin: 56, ageMax: 60, rates: { platinumPlus: 123308, platinum: 102724, gold: 61019, silver: 46303 } } ];
        const familySemiAnnualRates = [ { ageMin: 0, ageMax: 5, rates: { platinumPlus: 31971, platinum: 20824, gold: 16750, silver: 13179 } }, { ageMin: 6, ageMax: 10, rates: { platinumPlus: 26162, platinum: 16729, gold: 13501, silver: 10736 } }, { ageMin: 11, ageMax: 15, rates: { platinumPlus: 22791, platinum: 13568, gold: 11133, silver: 9217 } }, { ageMin: 16, ageMax: 20, rates: { platinumPlus: 20793, platinum: 12416, gold: 9945, silver: 8757 } }, { ageMin: 21, ageMax: 25, rates: { platinumPlus: 20998, platinum: 13270, gold: 9805, silver: 8727 } }, { ageMin: 26, ageMax: 30, rates: { platinumPlus: 21990, platinum: 14619, gold: 11542, silver: 9682 } }, { ageMin: 31, ageMax: 35, rates: { platinumPlus: 24871, platinum: 17593, gold: 13475, silver: 10488 } }, { ageMin: 36, ageMax: 40, rates: { platinumPlus: 28385, platinum: 22242, gold: 17078, silver: 12490 } }, { ageMin: 41, ageMax: 45, rates: { platinumPlus: 36748, platinum: 28901, gold: 21280, silver: 17991 } }, { ageMin: 46, ageMax: 50, rates: { platinumPlus: 49303, platinum: 38640, gold: 27105, silver: 22416 } }, { ageMin: 51, ageMax: 55, rates: { platinumPlus: 57958, platinum: 47140, gold: 28464, silver: 22516 } }, { ageMin: 56, ageMax: 60, rates: { platinumPlus: 66586, platinum: 55471, gold: 32950, silver: 25004 } } ];

        const RIDER_COSTS = { dental: { annual: 387, semiAnnual: 209 }, criticalIllness: { annual: 537, semiAnnual: 290 } };

        function initMyMaxicare() {
            document.getElementById('age-input').addEventListener('input', calculateMyMaxicare);
            document.getElementById('dental-toggle').addEventListener('change', calculateMyMaxicare);
            document.getElementById('ci-toggle').addEventListener('change', calculateMyMaxicare);
            calculateMyMaxicare();
        }

        function toggleAccountType(type) {
            const indLabel = document.getElementById('type-ind-label');
            const famLabel = document.getElementById('type-fam-label');
            const indInput = document.getElementById('individual-input');
            const famInput = document.getElementById('family-input');

            if (type === 'individual') {
                indLabel.classList.add('bg-white', 'shadow-sm', 'text-blue-700', 'ring-1', 'ring-black/5');
                indLabel.classList.remove('text-slate-500');
                famLabel.classList.remove('bg-white', 'shadow-sm', 'text-blue-700', 'ring-1', 'ring-black/5');
                famLabel.classList.add('text-slate-500');
                indInput.classList.remove('hidden');
                famInput.classList.add('hidden');
            } else {
                famLabel.classList.add('bg-white', 'shadow-sm', 'text-blue-700', 'ring-1', 'ring-black/5');
                famLabel.classList.remove('text-slate-500');
                indLabel.classList.remove('bg-white', 'shadow-sm', 'text-blue-700', 'ring-1', 'ring-black/5');
                indLabel.classList.add('text-slate-500');
                famInput.classList.remove('hidden');
                indInput.classList.add('hidden');
            }
            calculateMyMaxicare();
        }

        function addFamilyMember() {
            const container = document.getElementById('family-members-container');
            const index = container.children.length;
            const div = document.createElement('div');
            div.className = 'flex gap-2';
            div.innerHTML = `
                <input type="number" placeholder="Member ${index + 1} Age" class="fam-age-input w-full px-4 py-3 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-slate-50" oninput="calculateMyMaxicare()">
                ${index > 0 ? `<button onclick="this.parentElement.remove(); calculateMyMaxicare()" class="text-red-400 p-3 text-xl font-bold hover:bg-red-50 rounded-lg">&times;</button>` : ''}
            `;
            container.appendChild(div);
        }

        function getRate(age, isFamily, isAnnual) {
            if (!age && age !== 0) return null;
            let table;
            if (isAnnual) {
                table = isFamily ? familyAnnualRates : individualAnnualRates;
            } else {
                table = isFamily ? familySemiAnnualRates : individualSemiAnnualRates;
            }
            const bracket = table.find(r => age >= r.ageMin && age <= r.ageMax);
            return bracket ? bracket.rates : null;
        }

        function calculateMyMaxicare() {
            const isFamily = document.querySelector('input[name="accountType"]:checked').value === 'family';
            
            // Riders
            let annualRiderCost = 0;
            let semiAnnualRiderCost = 0;
            const activeRiders = [];

            if (document.getElementById('dental-toggle').checked) {
                annualRiderCost += RIDER_COSTS.dental.annual;
                semiAnnualRiderCost += RIDER_COSTS.dental.semiAnnual;
                activeRiders.push('Dental');
            }
            if (document.getElementById('ci-toggle').checked) {
                annualRiderCost += RIDER_COSTS.criticalIllness.annual;
                semiAnnualRiderCost += RIDER_COSTS.criticalIllness.semiAnnual;
                activeRiders.push('Critical Illness');
            }
            
            let ages = [];
            if (isFamily) {
                document.querySelectorAll('.fam-age-input').forEach(i => { if(i.value) ages.push(parseInt(i.value)) });
            } else {
                const val = document.getElementById('age-input').value;
                if(val) ages.push(parseInt(val));
            }

            let annualTotals = { silver: 0, gold: 0, platinum: 0, platinumPlus: 0 };
            let semiAnnualTotals = { silver: 0, gold: 0, platinum: 0, platinumPlus: 0 };
            let monthlyTotals = { silver: 0, gold: 0, platinum: 0, platinumPlus: 0 };

            let valid = ages.length > 0;
            let useFamilyRate = isFamily && ages.length >= 2;

            ages.forEach(age => {
                const annualRates = getRate(age, useFamilyRate, true);
                const semiRates = getRate(age, useFamilyRate, false);
                
                if (annualRates && semiRates) {
                    annualTotals.silver += annualRates.silver + annualRiderCost;
                    annualTotals.gold += annualRates.gold + annualRiderCost;
                    annualTotals.platinum += annualRates.platinum + annualRiderCost;
                    annualTotals.platinumPlus += annualRates.platinumPlus + annualRiderCost;

                    semiAnnualTotals.silver += semiRates.silver + semiAnnualRiderCost;
                    semiAnnualTotals.gold += semiRates.gold + semiAnnualRiderCost;
                    semiAnnualTotals.platinum += semiRates.platinum + semiAnnualRiderCost;
                    semiAnnualTotals.platinumPlus += semiRates.platinumPlus + semiAnnualRiderCost;

                    // Monthly Calculation: Annual / 10
                    // Note: Riders are also included in annual cost before division? 
                    // Usually riders are part of the total premium. Assuming yes.
                    monthlyTotals.silver += (annualRates.silver + annualRiderCost) / 10;
                    monthlyTotals.gold += (annualRates.gold + annualRiderCost) / 10;
                    monthlyTotals.platinum += (annualRates.platinum + annualRiderCost) / 10;
                    monthlyTotals.platinumPlus += (annualRates.platinumPlus + annualRiderCost) / 10;

                } else {
                    valid = false;
                }
            });
            
            // Store current calculated annual totals globally for brochure use
            currentQuote = annualTotals;
            currentSemiQuote = semiAnnualTotals; 
            currentMonthlyQuote = monthlyTotals;
            currentActiveRiders = activeRiders; 
            renderPlanGrid(annualTotals, semiAnnualTotals, monthlyTotals, valid, activeRiders);
        }

        function renderPlanGrid(annualTotals, semiAnnualTotals, monthlyTotals, valid, activeRiders) {
            const plans = [
                { key: 'silver', name: 'Silver', mbl: '100k', room: 'Semi-Private', bg: 'https://i.imgur.com/AZayUDB.png' },
                { key: 'gold', name: 'Gold', mbl: '150k', room: 'Regular Private', bg: 'https://i.imgur.com/VLmnPq4.png' },
                { key: 'platinum', name: 'Platinum', mbl: '200k', room: 'Regular Private', bg: 'https://i.imgur.com/Ps6RNvk.png' },
                { key: 'platinumPlus', name: 'Platinum Plus', mbl: '250k', room: 'Large Private', bg: 'https://i.imgur.com/Vguiixx.png' }
            ];

            const ridersText = activeRiders.length > 0 ? `<b>Added:</b> ${activeRiders.join(', ')}` : '';

            const grid = document.getElementById('mymaxicare-grid');
            grid.innerHTML = plans.map(p => {
                // Generate specific benefits content for this plan (for modal)
                const planSpecificContent = `
                    <div class="mb-6 bg-blue-50/80 p-5 border-l-4 border-blue-500 rounded-r-xl">
                        <h4 class="font-bold text-lg text-blue-900">${p.name} Plan Highlights</h4>
                        <ul class="list-disc pl-5 mt-2 text-slate-700">
                            <li><b>Max Benefit Limit (MBL):</b> ₱${p.mbl.replace('k',',000')} per illness/year</li>
                            <li><b>Room & Board:</b> ${p.room}</li>
                        </ul>
                    </div>
                    ${myMaxicareGeneralDetails}
                `;
                
                myMaxicareDetails[p.key] = planSpecificContent;
                
                return `
                <div class="mymax-card product-card hover:scale-[1.01] transition-transform duration-300" style="background-image: url('${p.bg}');">
                    <!-- Pricing Top Left -->
                    <div class="absolute flex flex-col justify-center text-shadow" style="top: 18%; left: 5%; width: 85%; height: 22%;">
                        <div>
                            <span class="card-annual-price">${valid ? formatCurrency(annualTotals[p.key]) : '₱--,--'}</span>
                            <span class="card-price-label">/year</span>
                        </div>
                        <div class="-mt-1 flex items-baseline gap-2">
                            <div>
                                <span class="card-semiannual-price text-gray-200">${valid ? formatCurrency(semiAnnualTotals[p.key]) : '₱--,--'}</span>
                                <span class="card-price-label">/sem</span>
                            </div>
                            <div class="relative group">
                                <span class="card-semiannual-price text-yellow-300 border-b border-dashed border-yellow-300/50 cursor-help">${valid ? formatCurrency(monthlyTotals[p.key]) : '₱--,--'}</span>
                                <span class="card-price-label text-yellow-100">/mo*</span>
                            </div>
                        </div>
                        <div class="text-[0.55rem] font-medium text-yellow-100 mt-0.5 opacity-90 tracking-wide">*Exclusive to BPI/Metro CC (12 mos)</div>
                    </div>

                    <!-- Benefits Bottom Left -->
                    <div class="absolute flex flex-col justify-start text-shadow" style="top: 53%; left: 5%; width: 50%; height: 40%;">
                        <ul class="card-benefits-text list-none p-0 space-y-0.5">
                            <li><span class="font-bold">Benefit Limit:</span> ₱${p.mbl}</li>
                            <li><span class="font-bold">Room:</span> ${p.room}</li>
                            <li>In-Patient, Out-Patient & ER</li>
                            <li>Annual Check-up (ACU)</li>
                        </ul>
                        <div class="mt-1 pt-1 border-t border-white/30 text-[0.65rem] font-medium text-blue-100">
                            ${ridersText}
                        </div>
                    </div>
                    
                    <!-- Action Buttons Bottom Right -->
                    <div class="absolute bottom-24 right-4 z-20">
                        <button onclick="showDetails('MyMaxicare ${p.name}', '${p.key}')" class="bg-white/10 hover:bg-white/30 backdrop-blur-md rounded-full px-5 py-2 text-xs font-bold border border-white/40 transition-all shadow-lg text-white tracking-wide">View Details</button>
                    </div>
                </div>
            `}).join('');
        }

        // --- CLINICS (Excerpt) ---
        function loadClinics() {
             const clinics = [
                { name: "Alabang PCC", address: "G/F Southkey Hub, Indo-China Drive, Northgate Filinvest, Alabang", contact: "(02) 7798-7739 | pcc.alabang@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Laboratory", "General Ultrasound", "OB-Sono Ultrasound"], specialists: ["Internal Medicine", "Family Medicine", "General Medicine", "Pediatrics", "ENT", "OB-Gyne", "Dermatology", "Ophthalmology", "Psychiatry", "Cardiology"] },
                { name: "Ayala North Exchange PCC", address: "2/F The Shops, Ayala North Exchange, Makati City", contact: "(02) 7798-7739 | pcc.ayalanorthexchange@maxicare.com.ph", hours: "24 Hours (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "X-Ray", "2D Echo", "Treadmill"], specialists: ["Internal Medicine", "Family Medicine", "Pediatrics", "ENT", "OB-Gyne", "Dermatology", "Ophthalmology", "Cardiology", "Endocrinology"] },
                { name: "Bacolod PCC", address: "G/F LOPUES MANDALAGAN Building, Lacson St., Mandalagan, Bacolod City", contact: "(034) 458 6715 | pcc.bacolod@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Laboratory", "ECG", "Ultrasound", "X-Ray", "2D Echo"], specialists: ["IM", "Family Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Psychiatry", "Ophtha", "Cardio", "Nephro"] },
                { name: "Baguio PCC", address: "G/F Patria de Baguio, Porta Vaga Mall, Session Road, Baguio City", contact: "(074) 661 8833 | pcc.baguio@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Laboratory", "General Ultrasound", "ECG", "X-Ray"], specialists: ["IM", "Gen Med", "ENT", "OB-Gyne", "Pedia", "Ophtha", "Gen Surg", "Nephro", "Endo", "Ortho"] },
                { name: "Bonifacio Technology Center PCC (BGC)", address: "2nd Ave cor 31st St. BTC, BGC, Taguig", contact: "(02) 7798-7739 | pcc.bonifaciotechcenter@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "X-Ray", "CT-Scan", "MRI", "Ultrasound", "ECG"], specialists: ["Gen Prac", "IM", "Fam Med", "OB-Gyne", "ENT", "Ophtha", "Pedia", "Derma", "Psych", "Gastro", "Cardio", "Nephro", "Pulmo", "Endo", "Rheuma", "Uro", "Gen Surg", "Ortho"] },
                { name: "Bridgetowne PCC", address: "Unit 1-3, Zeta Tower, Bridgetowne, C-5 Road, Quezon City", contact: "(02) 7798-7739 | pcc.bridgetowne@maxicare.com.ph", hours: "24 Hours (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "Treadmill", "X-Ray", "2D Echo"], specialists: ["IM", "Pedia", "Fam Med", "ENT", "Gen Med", "OB-Gyne", "Cardio", "Ortho", "Endo", "Uro", "Gastro", "Pulmo", "Gen Surg"] },
                { name: "Cagayan De Oro PCC", address: "G/F Primavera City Citta Verde, Pueblo De Oro, CDO", contact: "(088) 864 8804 | pcc.cdo@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "X-ray", "2D Echo"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "OB-Gyne", "ENT", "Cardio", "Ophtha"] },
                { name: "Cebu Business Park PCC", address: "Lot 5, Block 6, Mindanao Ave, Cebu Business Park, Cebu City", contact: "(032) 260-9067 | pcc.cebu@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "Treadmill", "X-Ray", "2D Echo"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Psych", "Cardio", "Endo", "Infectious", "Nephro", "Gastro", "Pulmo", "Rheuma"] },
                { name: "Cebu Exchange PCC", address: "Ground Floor Cebu Exchange Tower, Salinas Dr., Cebu City", contact: "(02) 7798-7739 | pcc.cebuexchange@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Laboratory", "Ultrasound", "2D Echo", "ECG"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Ophtha", "Endo", "Nephro", "Gastro", "Pulmo"] },
                { name: "Cebu Skyrise PCC", address: "Block 8, Lot 3 Cebu IT Park Subdivision, Barangay Apas, Cebu City", contact: "(032) 260 9069 | pcc.cebuskyrise@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "Treadmill", "X-Ray", "2D Echo"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "OB-Gyne", "Cardio", "Nephro"] },
                { name: "Centris PCC", address: "G/F Cyberpod Centris 5, Eton Centris, Quezon City", contact: "(02) 7908-6925 | pcc.centris@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Lab", "Ultrasound", "ECG", "Treadmill", "2D Echo", "X-Ray", "Physical Therapy"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Psych", "Cardio", "Endo", "Gastro", "Pulmo", "Nephro", "Rheuma", "Infectious", "Ortho", "Uro", "Gen Surg", "Rehab Med"] },
                { name: "Clark PCC", address: "G/F City Clark, Tech Hub 6, Manuel A. Roxas Highway, Clark Freeport", contact: "91/8300252 | pcc.clark@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "Treadmill", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Ophtha", "Pulmo", "Nephro", "Onco", "Gen Surg"] },
                { name: "Cubao PCC", address: "UGF, Cyberpark Tower 2, Araneta City, Cubao, QC", contact: "(02) 7798-7739 | pcc.cubao@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "ECG", "Ultrasound", "X-Ray", "2D Echo"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Psych", "Endo", "Gastro", "Pulmo", "Nephro", "Infectious", "Ortho", "Gen Surg", "Uro"] },
                { name: "Davao PCC", address: "G/F Abreeza Mall J.P Laurel Avenue, Bajada, Davao City", contact: "(082) 293 2446 | pcc.davao@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Psych", "Cardio", "Endo", "Pulmo", "Nephro"] },
                { name: "Dona Elena Tower PCC", address: "2nd Level, P. Sanchez Street, Santa Mesa, Manila", contact: "(02) 7798-7739 | pcc.donaelena@maxicare.com.ph", hours: "6:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Psych", "Cardio", "Endo", "Gastro", "Pulmo", "Nephro", "Onco"] },
                { name: "Double Dragon Meridian Park PCC", address: "G/F Tower 2, Double Dragon Meridian Park, Pasay City", contact: "(02) 7798-7739 | pcc.doubledragonmp@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Psych", "Cardio", "Gastro", "Pulmo", "Nephro", "Ortho", "Gen Surg"] },
                { name: "Fairview PCC", address: "Unit 1&2 AD Center, Regalado Hi-Way, Fairview, QC", contact: "(02) 7798-7739 | pcc.fairview@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Psych", "Cardio", "Gastro", "Pulmo", "Infectious", "Ortho", "Uro", "Gen Surg"] },
                { name: "Hemady PCC", address: "Hemady Square 86 Dona Hemady St. Cor E. Rodriguez Sr Ave., QC", contact: "(02) 7798-7739 | pcc.hemady@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "IM", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Cardio", "Nephro", "Endo", "Pulmo", "Gastro", "Gen Surg", "Ortho", "Uro"] },
                { name: "Iloilo PCC", address: "Unit 4, Three Techno Place, Megaworld Blvd, Iloilo City", contact: "(033) 3287031 | pcc.iloilo@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "Treadmill", "X-Ray", "2D Echo"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Psych", "Nephro", "Rheuma", "Ortho"] },
                { name: "Imus PCC", address: "Metro MPC Building, Imus, Cavite", contact: "(046) 419 8017 | pcc.imus@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT"] },
                { name: "Parañaque PCC", address: "GF, SM City Mall BF Parañaque, Sucat, Parañaque City", contact: "09171639670 | pcc.smbfparanaque@maxicare.com.ph", hours: "7:00 AM - 09:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT", "Pulmo", "Nephro"] },
                { name: "Robinsons Las Pinas PCC", address: "Level 2, Robinsons Place Las Pinas, Alabang Zapote Road", contact: "(02) 7798-7739 | pcc.robinsonslaspinas@maxicare.com.ph", hours: "07:00 AM - 4:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT", "OB-Gyne", "Derma", "Pulmo", "Rheuma", "Infectious", "Uro"] },
                { name: "Robinsons Malolos PCC", address: "4th Level, Robinsons Malolos, Bulacan", contact: "(02) 7798-7739 | pcc.robinsonsmalolos@maxicare.com.ph", hours: "6:00 AM - 9:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT", "OB-Gyne", "Ophtha", "Gen Surg"] },
                { name: "Robinsons Metro East PCC", address: "4th Level, Robinsons Metro East, Pasig City", contact: "(02) 7798-7739 | pcc.robinsonsmetroeast@maxicare.com.ph", hours: "06:00 AM - 9:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Endo", "Gen Surg", "Nephro", "Rheuma", "Infectious", "Ortho", "Uro"] },
                { name: "Robinsons Novaliches PCC", address: "Ground Floor, Robinsons Novaliches, QC", contact: "9171097246 | pcc.robinsonsnovaliches@maxicare.com.ph", hours: "6:00 AM - 9:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Pulmo", "Gen Surg", "Nephro", "Infectious", "Uro"] },
                { name: "Robinsons Otis PCC", address: "2nd Floor Robinsons Mall Otis, Paco Manila", contact: "(02) 7798-7739 | pcc.robinsonsotis@maxicare.com.ph", hours: "6:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "IM", "Fam Med", "Cardio", "Pedia", "ENT", "OB-Gyne", "Derma", "Psych", "Ophtha", "Pulmo", "Gen Surg", "Nephro", "Endo", "Gastro"] },
                { name: "Robinsons Terraza Dasmariñas PCC", address: "2F Robinsons Terraza, Dasmarinas, Cavite", contact: "9171083042 | pcc.dasmarinas@maxicare.com.ph", hours: "6:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "2D Echo", "X-Ray", "CT Scan"], specialists: ["IM", "OB-Gyne", "Fam Med", "Derma", "Gen Med", "Pedia", "ENT", "Psych", "Cardio", "Gen Surg"] },
                { name: "Robinsons Starmills San Fernando PCC", address: "GF Robinsons Starmills, San Fernando, Pampanga", contact: "(02) 7798-7739 | pcc.robinsonsstarmills@maxicare.com.ph", hours: "6:00 AM - 9:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Cardio", "Ophtha", "Nephro", "Gen Surg", "Ortho"] },
                { name: "San Jose Del Monte PCC", address: "2F Skyline Drive Bldg., SJDM, Bulacan", contact: "(02) 7798-7739 | pcc.sjdm@maxicare.com.ph", hours: "6:00 AM - 9:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Cardio", "Ophtha", "Nephro", "Gen Surg", "Orthopedics"] },
                { name: "SOMO Vista Mall Bacoor PCC", address: "Ground floor, SOMO A Vista Mall, Molino, Bacoor", contact: "09171072769", hours: "6:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Cardio", "Ophtha", "Gen Surg", "Uro"] },
                { name: "Solenad PCC (Nuvali)", address: "G/F Solenad 2, Nuvali, Sta. Rosa, Laguna", contact: "(049) 559 8003 | pcc.laguna@maxicare.com.ph", hours: "06:00 AM - 08:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Cardio", "Ophtha", "Psych", "Gen Surg", "Infectious"] },
                { name: "The Mezzo Calamba PCC", address: "Ground Floor The Mezzo, Calamba, Laguna", contact: "(02) 7798-7739 | pcc.calamba@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo", "X-Ray"], specialists: ["Gen Med", "Fam Med", "IM", "OB-Gyne", "Pedia", "Derma", "ENT", "Psych", "Cardio", "Endo", "Gastro", "Pulmo"] },
                { name: "Valenzuela PCC", address: "Ground floor, H&L Building, Valenzuela", contact: "9171639660 | pcc.valenzuela@maxicare.com.ph", hours: "7:00 AM - 4:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "Ultrasound", "ECG", "2D Echo"], specialists: ["IM", "Gen Med", "Pedia", "ENT"] },
                { name: "VV Soliven PCC", address: "GF-SOL1, VV Soliven Shopping Complex, San Juan City", contact: "(02) 7798 7788 | pcc.vvsoliven@maxicare.com.ph", hours: "06:00 AM - 10:00 PM (Mon-Sun)", services: ["Consultation", "Lab", "CT Scan", "Ultrasound", "ECG", "2D Echo", "X-Ray", "Treadmill"], specialists: ["IM", "Fam Med", "Gen Med", "Pedia", "ENT", "OB-Gyne", "Derma", "Ophtha", "Ortho", "Gen Surg", "Cardio", "Psych", "Pulmo", "Nephro", "Endo", "Gastro", "Rheuma", "Infectious", "Uro"] }
            ];
            // ... (Rest of clinic logic same as original)
            const results = document.getElementById('clinic-results');
            const search = document.getElementById('clinic-search');
            
            function renderClinics(list) {
                if(list.length === 0) {
                    results.innerHTML = `<p class="text-slate-500 text-center text-sm mt-4">No clinics found.</p>`;
                    return;
                }
                results.innerHTML = list.map((c, index) => `
                    <div class="bg-white p-4 rounded-2xl border border-slate-100 shadow-sm mb-3 transition-all">
                        <div class="cursor-pointer" onclick="document.getElementById('detail-${index}').classList.toggle('show'); document.getElementById('detail-${index}').classList.toggle('hidden')">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h4 class="font-bold text-blue-900 text-base mb-1">${c.name}</h4>
                                    <p class="text-sm text-slate-500 leading-relaxed">${c.address}</p>
                                </div>
                                <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </div>
                        </div>
                        <div id="detail-${index}" class="clinic-detail-row hidden mt-3 pt-3 border-t border-slate-50 text-sm text-slate-600 space-y-2">
                            <p><span class="font-bold text-blue-600">📞</span> ${c.contact}</p>
                            <p><span class="font-bold text-blue-600">🕒</span> ${c.hours}</p>
                            <div><span class="font-bold text-slate-800 block mb-1">Services:</span><div class="flex flex-wrap gap-1">${c.services.map(s => `<span class="bg-blue-50 text-blue-600 text-xs px-2 py-0.5 rounded-md">${s}</span>`).join('')}</div></div>
                        </div>
                    </div>
                `).join('');
            }
            
            renderClinics(clinics); 

            search.addEventListener('input', (e) => {
               const term = e.target.value.toLowerCase();
               const filtered = clinics.filter(c => c.name.toLowerCase().includes(term) || c.address.toLowerCase().includes(term));
               renderClinics(filtered);
            });
        }
    </script>
</body>
</html>
